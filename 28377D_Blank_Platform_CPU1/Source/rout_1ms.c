//###############################################################################################################
// 파일명      : rout_1ms.c
// 회사명      : G-Philos
// 작성날짜  : 2020.12.17
// 작성자      : KYJ-PC
// 수정날짜  : 2021.01.04
// 수정자      : Lee Sang Cheol
// 설명         : 1ms routine
//###############################################################################################################

#include "Define.h"

float test = 0;
float test_cnt = -128.0;
float test_cnt2 = 127.0;

const float sin_cnt[256] =
{
 0,
 0.0246,
 0.0491,
 0.0737,
 0.0982,
 0.1226,
 0.1470,
 0.1712,
 0.1954,
 0.2194,
 0.2434,
 0.2671,
 0.2907,
 0.3142,
 0.3374,
 0.3604,
 0.3833,
 0.4058,
 0.4282,
 0.4503,
 0.4721,
 0.4936,
 0.5148,
 0.5358,
 0.5563,
 0.5766,
 0.5965,
 0.6161,
 0.6352,
 0.6540,
 0.6724,
 0.6904,
 0.7080,
 0.7251,
 0.7418,
 0.7581,
 0.7739,
 0.7892,
 0.8041,
 0.8185,
 0.8323,
 0.8457,
 0.8586,
 0.8709,
 0.8827,
 0.8940,
 0.9048,
 0.9150,
 0.9246,
 0.9337,
 0.9422,
 0.9502,
 0.9575,
 0.9643,
 0.9705,
 0.9762,
 0.9812,
 0.9857,
 0.9895,
 0.9928,
 0.9954,
 0.9975,
 0.9989,
 0.9998,
 1.0000,
 0.9996,
 0.9987,
 0.9971,
 0.9949,
 0.9921,
 0.9888,
 0.9848,
 0.9802,
 0.9751,
 0.9693,
 0.9630,
 0.9561,
 0.9486,
 0.9405,
 0.9319,
 0.9227,
 0.9129,
 0.9026,
 0.8918,
 0.8804,
 0.8684,
 0.8560,
 0.8430,
 0.8296,
 0.8156,
 0.8011,
 0.7862,
 0.7707,
 0.7548,
 0.7385,
 0.7217,
 0.7045,
 0.6868,
 0.6687,
 0.6502,
 0.6314,
 0.6121,
 0.5925,
 0.5725,
 0.5522,
 0.5315,
 0.5105,
 0.4893,
 0.4677,
 0.4458,
 0.4237,
 0.4013,
 0.3786,
 0.3558,
 0.3327,
 0.3094,
 0.2859,
 0.2623,
 0.2385,
 0.2146,
 0.1905,
 0.1663,
 0.1420,
 0.1176,
 0.0932,
 0.0687,
 0.0442,
 0.0196,
 -0.0050,
 -0.0296,
 -0.0541,
 -0.0787,
 -0.1031,
 -0.1276,
 -0.1519,
 -0.1762,
 -0.2003,
 -0.2243,
 -0.2482,
 -0.2719,
 -0.2955,
 -0.3189,
 -0.3421,
 -0.3651,
 -0.3879,
 -0.4104,
 -0.4327,
 -0.4547,
 -0.4765,
 -0.4980,
 -0.5191,
 -0.5400,
 -0.5605,
 -0.5807,
 -0.6005,
 -0.6200,
 -0.6391,
 -0.6578,
 -0.6761,
 -0.6940,
 -0.7115,
 -0.7286,
 -0.7452,
 -0.7614,
 -0.7771,
 -0.7923,
 -0.8071,
 -0.8213,
 -0.8351,
 -0.8484,
 -0.8611,
 -0.8734,
 -0.8851,
 -0.8962,
 -0.9069,
 -0.9170,
 -0.9265,
 -0.9355,
 -0.9439,
 -0.9517,
 -0.9590,
 -0.9656,
 -0.9717,
 -0.9772,
 -0.9822,
 -0.9865,
 -0.9902,
 -0.9933,
 -0.9959,
 -0.9978,
 -0.9991,
 -0.9999,
 -1.0000,
 -0.9995,
 -0.9984,
 -0.9967,
 -0.9944,
 -0.9915,
 -0.9880,
 -0.9839,
 -0.9792,
 -0.9740,
 -0.9681,
 -0.9616,
 -0.9546,
 -0.9470,
 -0.9388,
 -0.9301,
 -0.9207,
 -0.9109,
 -0.9005,
 -0.8895,
 -0.8780,
 -0.8660,
 -0.8534,
 -0.8403,
 -0.8268,
 -0.8127,
 -0.7981,
 -0.7831,
 -0.7675,
 -0.7515,
 -0.7351,
 -0.7182,
 -0.7009,
 -0.6831,
 -0.6650,
 -0.6464,
 -0.6275,
 -0.6082,
 -0.5885,
 -0.5684,
 -0.5480,
 -0.5273,
 -0.5062,
 -0.4849,
 -0.4632,
 -0.4413,
 -0.4191,
 -0.3967,
 -0.3740,
 -0.3511,
 -0.3280,
 -0.3047,
 -0.2812,
 -0.2575,
 -0.2336,
 -0.2097,
 -0.1856,
 -0.1614,
 -0.1371,
 -0.1127,
 -0.0882,
 -0.0637,
 -0.0392,
 -0.0146,
};

int test_delay = 0;

void rout_1ms()
{
    if(time_check_cnt == 5)   LED1_ON;

    test_delay++;
    if( test_delay > 10 )
    {
        test_delay = 0;

        test_cnt++;
    }

    test_cnt2 = sin_cnt[(int)(test_cnt + 128)];

    if(test_cnt2 >= 0)
    {
        //test_cnt2 = 32768;
        //test_cnt2 = 2048;
        test_cnt2 = 1.5;
    }
    else
    {
        //test_cnt2 = 256;
        //test_cnt2 = 0;
        test_cnt2 = -5.39;
    }

    if(test_cnt >= 127)
        test_cnt = -128;

    sig_test0 = sin_cnt[(int)(test_cnt + 128 +   0) % 256];
    sig_test1 = sin_cnt[(int)(test_cnt + 128 +  64) % 256];
    sig_test2 = sin_cnt[(int)(test_cnt + 128 + 128) % 256];
    sig_test3 = sin_cnt[(int)(test_cnt + 128 + 192) % 256];
    sig_test4 = sin_cnt[(int)(test_cnt + 128 +   0) % 256];
    sig_test5 = sin_cnt[(int)(test_cnt + 128 +  64) % 256];

    rout_1ms_count++;

    if(time_check_cnt == 5)   LED1_OFF;
}
